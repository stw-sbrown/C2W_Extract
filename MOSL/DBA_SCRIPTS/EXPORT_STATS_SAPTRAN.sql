--*** SCRIPT TO GENERATE TABLE STAT SCRIPTS
--SELECT 'EXEC DBMS_STATS.EXPORT_TABLE_STATS(''SAPTRAN'',''' || table_name || ''',NULL,''TRANSTATSTABLE''); '
--from dba_tables where owner = 'SAPTRAN' and table_name NOT LIKE '%$%' AND status = 'VALID'
--AND table_name <> 'TRANSTATSTABLE'
--ORDER BY 1;

--1. **** DROP PREVIOUS STATS TABLE
DROP TABLE SAPTRAN.TRANSTATSTABLE PURGE;

--2. **** CREATE STATS TABLE
EXEC DBMS_STATS.CREATE_STAT_TABLE('SAPTRAN','TRANSTATSTABLE');

--3. **** EXPORT STATS
EXEC DBMS_STATS.EXPORT_SCHEMA_STATS('SAPTRAN','TRANSTATSTABLE');

EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_BAD_DATA',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_CLOCKOVER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_FOREIGN_ADDRESSES',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_INSTALL_ADDRESS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_METER_NETWORK',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_METER_READ_FREQ',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_MISS_AG_SC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_OWC_CUST_SWITCHED_SUPPLIER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SC_AS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SC_MPW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SC_UW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SENSI_SITE_SPECIFIC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SPR_METER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SPR_TARIFF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SPR_TARIFF_ALGITEM',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SPR_TARIFF_EXTREF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SP_TARIFF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SP_TARIFF_ALG',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SP_TARIFF_ALGITEM',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SP_TARIFF_EXTREF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SP_TARIFF_REFTAB',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_SP_TARIFF_SPLIT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_TE_SUMMARY',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_TE_WORKING',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_TVP054',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','BT_TVP163',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','GIS_VALIDATE_TEMP',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_CONSTRUCTION_SITE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_CROSSBORDER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_DATALOGGERS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_DISCHARGE_VOL_LIMITS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_LANDLORD',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_METER_MANUFACTURER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_OUTREADER_PROTOCOLS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_PUBHEALTHRESITE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_SAP_EQUIPMENT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_SAP_FLOCA',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_SERVICE_CATEGORY',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_SPID_OWC_RETAILER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_SPID_RANGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_TARIFF_SPECIAL_AGREEMENTS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_TE_BILLING_CYCLE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','LU_TE_REFDESC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_BATCHSTATUS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_CPLOG',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_CPREF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_ERRORLOG',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_ERRREF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_JOBREF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MIG_JOBSTATUS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_AS_BAND_CHARGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_AS_METER_ASMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_AW_BAND_CHARGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_AW_METER_AWMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_CALCULATED_DISCHARGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_CUSTOMER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_DISCHARGED_VOLUME',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_DISCHARGE_POINT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_DISCHARGE_POINT_VOLMET_ADJ',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_ELIGIBLE_PREMISES',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_HD_AREA_BAND',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_HD_BAND_CHARGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_HD_BLOCK_HDBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_HD_METER_HDMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_METER',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_METER_DPIDXREF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_METER_NETWORK',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_METER_READING',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_METER_SPID_ASSOC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MNPW_BLOCK_MWBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MNPW_METER_MWMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MNPW_STANDBY_MWCAPCHG',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MPW_BLOCK_MWBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MPW_METER_MWMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MPW_STANDBY_MWCAPCHG',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MS_BLOCK_MSBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_MS_METER_MSMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_ORG',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SERVICE_COMPONENT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SERVICE_COMPONENT_TYPE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SERVICE_COMPONENT_VOL_ADJ',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SUPPLY_POINT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SW_AREA_BAND',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SW_BAND_CHARGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SW_BLOCK_SWBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_SW_METER_SWMFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_STANDING_DATA',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_AS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_AW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_HD',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_MNPW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_MPW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_MS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_SCA',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_SW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_TE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_US',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_UW',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_TYPE_WCA',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TARIFF_VERSION',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TE_BAND_CHARGE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TE_BLOCK_BOBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_TE_BLOCK_ROBT',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_US_METER_USPFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','MO_UW_METER_UWPFC',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_ADDRESS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_CUST_ADDRESS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_DPID_TYPE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_METER_ADDRESS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_PROPERTY_ADDRESS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_SENSITIVE',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_SENSI_EMERGENCY_PLANS',NULL,'TRANSTATSTABLE'); 
EXEC DBMS_STATS.EXPORT_TABLE_STATS('SAPTRAN','SAP_SEWERAGE_TREATMENT_WORKS',NULL,'TRANSTATSTABLE'); 

commit;
exit;