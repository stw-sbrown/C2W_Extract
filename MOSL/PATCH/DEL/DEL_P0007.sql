------------------------------------------------------------------------------
-- TASK		    		    : 	MOSL DEL RDBMS PATCHES 
--
-- AUTHOR         		: 	K.Burton
--
-- FILENAME       		: 	DEL_P0007.sql
--
--
-- Subversion $Revision: 5333 $	
--
-- CREATED        		: 	13/05/2016
--	
-- DESCRIPTION 		   	: 	This file contains all ongoing patches that are made to the MOSL DEL database
--
-- NOTES  			      :	Place a summary at the top of the file with more detailed information 
--					where the patch is applied in this script (if needed)
--
-- ASSOCIATED FILES		:	
-- ASSOCIATED SCRIPTS :	
---------------------------- Modification History ----------------------------------------------------------
--
-- Version     	  Date            Author          Description
-- ---------      ----------      -------         ----------------------------------------------------------
-- V0.01	  13/05/2016	  K.Burton        Create new views for crossborder file generation
-- V0.02    15/06/2016    L.Smith         Remove the '/' from the end of the file.
--                                        Added two missing regions
--                                        I233 - Set cross border on for all regions and prevent the last entry duplicating.
-- V0.03    16/06/2016    L.Smith         I237 - Amend supply point views to drive the query from DEL_SUPPLY_POINT
-- V0.04  ` 20/06/2016    D.Cheung        I240 - Remove NON-Output fields from DEL_DISCHARGE_POINT crossborder views
-- V0.05    30/06/2016    K.Burton        CR_022 - Crossborder files need to be based only on WHOLESALER_ID - there are some
--                                        special agreements already in place which means a few cases where retailer and
--                                        wholesaler are different which causes the crossborder data to be included in 2
--                                        different file.
-- V0.06    11/07/2016    K.Burton        I-279 - Changes to ensure non-market meters are included in STW meter related views
-- V0.07    13/07/2016    D.Cheung        I-285 - Add check for NONMARKETMETER on DEL_METER_NETWORK_STW_V
-- V0.08    15/08/2016    S.Badhan        I-320. Remove schema name from view.
-- V0.09    15/08/2016    K.Burton        SAP Defect 124 - SIC codes need to be 5 characters for SAP 
--                                        - left pad with leading 0's where required.
------------------------------------------------------------------------------------------------------------
-- CHANGES
-- CREATE NEW VIEWS FOR CROSSBORDER FILE GENERATION:
-- 01.DEL_SUPPLY_POINT_STW_V (Severn Trent Water)
-- 02.DEL_SUPPLY_POINT_THW_V (Thames Water)
-- 03.DEL_SUPPLY_POINT_UUW_V (United Utilities)
-- 04.DEL_SUPPLY_POINT_YOW_V (Yorkshire Water)
-- 05.DEL_SUPPLY_POINT_WEW_V (Wessex Water)
-- 06.DEL_SUPPLY_POINT_WEL_V (Dwr Cymru)
-- 07.DEL_SUPPLY_POINT_SSW_V (South Staffs Water)
-- 08.DEL_SUPPLY_POINT_ANW_V (Anglian Water)
-- 09.DEL_SERVICE_COMPONENT_STW_V (Severn Trent Water)
-- 10.DEL_SERVICE_COMPONENT_THW_V (Thames Water)
-- 11.DEL_SERVICE_COMPONENT_UUW_V (United Utilities)
-- 12.DEL_SERVICE_COMPONENT_YOW_V (Yorkshire Water)
-- 13.DEL_SERVICE_COMPONENT_WEW_V (Wessex Water)
-- 14.DEL_SERVICE_COMPONENT_WEL_V (Dwr Cymru)
-- 15.DEL_SERVICE_COMPONENT_SSW_V (South Staffs Water)
-- 16.DEL_SERVICE_COMPONENT_ANW_V (Anglian Water)
-- 17.DEL_METER_STW_V (Severn Trent Water)
-- 18.DEL_METER_THW_V (Thames Water)
-- 18.DEL_METER_UUW_V (United Utilities)
-- 20.DEL_METER_YOW_V (Yorkshire Water)
-- 21.DEL_METER_WEW_V (Wessex Water)
-- 22.DEL_METER_WEL_V (Dwr Cymru)
-- 23.DEL_METER_SSW_V (South Staffs Water)
-- 24.DEL_METER_ANW_V (Anglian Water)
-- 25.DEL_METER_READING_STW_V (Severn Trent Water)
-- 26.DEL_METER_READING_THW_V (Thames Water)
-- 27.DEL_METER_READING_UUW_V (United Utilities)
-- 28.DEL_METER_READING_YOW_V (Yorkshire Water)
-- 29.DEL_METER_READING_WEW_V (Wessex Water)
-- 30.DEL_METER_READING_WEL_V (Dwr Cymru)
-- 31.DEL_METER_READING_SSW_V (South Staffs Water)
-- 32.DEL_METER_READING_ANW_V (Anglian Water)
-- 33.DEL_METER_SUPPLY_POINT_STW_V (Severn Trent Water)
-- 34.DEL_METER_SUPPLY_POINT_THW_V (Thames Water)
-- 35.DEL_METER_SUPPLY_POINT_UUW_V (United Utilities)
-- 36.DEL_METER_SUPPLY_POINT_YOW_V (Yorkshire Water)
-- 37.DEL_METER_SUPPLY_POINT_WEW_V (Wessex Water)
-- 38.DEL_METER_SUPPLY_POINT_WEL_V (Dwr Cymru)
-- 39.DEL_METER_SUPPLY_POINT_SSW_V (South Staffs Water)
-- 40.DEL_METER_SUPPLY_POINT_ANW_V (Anglian Water)
-- 41.DEL_METER_NETWORK_STW_V (Severn Trent Water)
-- 42.DEL_METER_NETWORK_THW_V (Thames Water)
-- 43.DEL_METER_NETWORK_UUW_V (United Utilities)
-- 44.DEL_METER_NETWORK_YOW_V (Yorkshire Water)
-- 45.DEL_METER_NETWORK_WEW_V (Wessex Water)
-- 46.DEL_METER_NETWORK_WEL_V (Dwr Cymru)
-- 47.DEL_METER_NETWORK_SSW_V (South Staffs Water)
-- 48.DEL_METER_NETWORK_ANW_V (Anglian Water)
-- 49.DEL_DISCHARGE_POINT_STW_V (Severn Trent Water)
-- 50.DEL_DISCHARGE_POINT_THW_V (Thames Water)
-- 51.DEL_DISCHARGE_POINT_UUW_V (United Utilities)
-- 52.DEL_DISCHARGE_POINT_YOW_V (Yorkshire Water)
-- 53.DEL_DISCHARGE_POINT_WEW_V (Wessex Water)
-- 54.DEL_DISCHARGE_POINT_WEL_V (Dwr Cymru)
-- 55.DEL_DISCHARGE_POINT_SSW_V (South Staffs Water)
-- 56.DEL_DISCHARGE_POINT_ANW_V (Anglian Water)
-- 57.DEL_METER_DISCHARGE_STW_V (Severn Trent Water)
-- 58.DEL_METER_DISCHARGE_THW_V (Thames Water)
-- 59.DEL_METER_DISCHARGE_UUW_V (United Utilities)
-- 60.DEL_METER_DISCHARGE_YOW_V (Yorkshire Water)
-- 61.DEL_METER_DISCHARGE_WEW_V (Wessex Water)
-- 62.DEL_METER_DISCHARGE_WEL_V (Dwr Cymru)
-- 63.DEL_METER_DISCHARGE_SSW_V (South Staffs Water)
-- 64.DEL_METER_DISCHARGE_ANW_V (Anglian Water)
-- 65.DEL_CALC_DISCHARGE_STW_V (Severn Trent Water)
-- 66.DEL_CALC_DISCHARGE_THW_V (Thames Water)
-- 67.DEL_CALC_DISCHARGE_UUW_V (United Utilities)
-- 68.DEL_CALC_DISCHARGE_YOW_V (Yorkshire Water)
-- 69.DEL_CALC_DISCHARGE_WEW_V (Wessex Water)
-- 70.DEL_CALC_DISCHARGE_WEL_V (Dwr Cymru)
-- 71.DEL_CALC_DISCHARGE_SSW_V (South Staffs Water)
-- 72.DEL_CALC_DISCHARGE_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------
-- 01.DEL_SUPPLY_POINT_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_STW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK = 'SEVERN-W' OR MSP.RETAILERID_PK LIKE 'SEVERN%')
  AND MSP.WHOLESALERID_PK = 'SEVERN-W' -- V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 02.DEL_SUPPLY_POINT_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_THW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'THAMES%' OR MSP.RETAILERID_PK LIKE 'THAMES%')
  AND MSP.WHOLESALERID_PK LIKE 'THAMES%' -- V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 03.DEL_SUPPLY_POINT_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_UUW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'UNITED%' OR MSP.RETAILERID_PK LIKE 'UNITED%')
  AND MSP.WHOLESALERID_PK LIKE 'UNITED%' --V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 04.DEL_SUPPLY_POINT_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_YOW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'YORKSHIRE%' OR MSP.RETAILERID_PK LIKE 'YORKSHIRE%')
  AND MSP.WHOLESALERID_PK LIKE 'YORKSHIRE%' --V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 05.DEL_SUPPLY_POINT_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_WEW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'WESSEX%' OR MSP.RETAILERID_PK LIKE 'WESSEX%')
  AND MSP.WHOLESALERID_PK LIKE 'WESSEX%' --V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 06.DEL_SUPPLY_POINT_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_WEL_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'DWRCYMRU%' OR MSP.RETAILERID_PK LIKE 'DWRCYMRU%')
  AND MSP.WHOLESALERID_PK LIKE 'DWRCYMRU%' --V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 07.DEL_SUPPLY_POINT_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_SSW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'SOUTHSTAFF%' OR MSP.RETAILERID_PK LIKE 'SOUTHSTAFF%')
  AND MSP.WHOLESALERID_PK LIKE 'SOUTHSTAFF%' --V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 08.DEL_SUPPLY_POINT_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_SUPPLY_POINT_ANW_V (SPID_PK, WHOLESALERID, RETAILERID, SERVICECATEGORY, SUPPLYPOINTEFFECTIVEFROMDATE, PAIRINGREFREASONCODE, OTHERWHOLESALERID, MULTIPLEWHOLESALERFLAG, DISCONRECONDEREGSTATUS, VOABAREFERENCE, VOABAREFRSNCODE, UPRN, UPRNREASONCODE, CUSTOMERCLASSIFICATION, PUBHEALTHRELSITEARR, NONPUBHEALTHRELSITE, NONPUBHEALTHRELSITEDSC, STDINDUSTRYCLASSCODE, STDINDUSTRYCLASSCODETYPE, RATEABLEVALUE, OCCUPENCYSTATUS, BUILDINGWATERSTATUS, LANDLORDSPID, SECTION154, CUSTOMERNAME, CUSTOMERBANNERNAME, PREMLOCATIONFREETEXTDESCRIPTOR, PREMSECONDADDRESABLEOBJECT, PREMPRIMARYADDRESSABLEOBJECT, PREMADDRESSLINE01, PREMADDRESSLINE02, PREMADDRESSLINE03, PREMADDRESSLINE04, PREMADDRESSLINE05, PREMPOSTCODE, PREMPAFADDRESSKEY, CUSTLOCATIONFREETEXTDESCRIPTOR, CUSTSECONDADDRESABLEOBJECT, CUSTPRIMARYADDRESSABLEOBJECT, CUSTADDRESSLINE01, CUSTADDRESSLINE02, CUSTADDRESSLINE03,
  CUSTADDRESSLINE04, CUSTADDRESSLINE05, CUSTPOSTCODE, CUSTCOUNTRY, CUSTPAFADDRESSKEY)
AS
  SELECT MSP.SPID_PK,
    MSP.WHOLESALERID_PK WHOLESALERID,
    MSP.RETAILERID_PK RETAILERID,
    MSP.SERVICECATEGORY,
    TO_DATE(TO_CHAR(NVL(MSP.SUPPLYPOINTEFFECTIVEFROMDATE,TO_DATE('2016-04-01','YYYY-MM-DD')),'YYYY-MM-DD'),'YYYY-MM_DD') SUPPLYPOINTEFFECTIVEFROMDATE,
    MSP.PAIRINGREFREASONCODE,
    MSP.OTHERWHOLESALERID, -- Must be populated with valid wholesaler id if PAIRINGREFREASONCODE is NULL
    MSP.MULTIPLEWHOLESALERFLAG,
    NVL(MSP.DISCONRECONDEREGSTATUS,'REC') DISCONRECONDEREGSTATUS,
    MEP.VOABAREFERENCE,  -- Must be populated only if VOABAREFRSNCODE is NULL
    MEP.VOABAREFRSNCODE, -- Must be populated only if VOABAREFERENCE is NULL
    MEP.UPRN,            -- Must be populated only if UPRNREASONCODE is NULL
    MEP.UPRNREASONCODE,  -- Must be populated only if UPRN is NULL
    NVL(MC.CUSTOMERCLASSIFICATION,'NA') CUSTOMERCLASSIFICATION,
    MEP.PUBHEALTHRELSITEARR,
    MEP.NONPUBHEALTHRELSITE,
    MEP.NONPUBHEALTHRELSITEDSC, -- Must be populated if NONPUBHEALTHRELSITE = 1
--    MC.STDINDUSTRYCLASSCODE,
    TO_CHAR(MC.STDINDUSTRYCLASSCODE,'00000') STDINDUSTRYCLASSCODE, -- V0.09 
    MC.STDINDUSTRYCLASSCODETYPE, -- Must be populated if STDINDUSTRYCLASSCODE is not NULL
    MEP.RATEABLEVALUE,
    MEP.OCCUPENCYSTATUS,
    MEP.BUILDINGWATERSTATUS,
    MSP.LANDLORDSPID, -- Must be valid MOSL supplied SPID if populated
    MEP.SECTION154 ,
    MC.CUSTOMERNAME,
    MC.CUSTOMERBANNERNAME,
    PMA.LOCATIONFREETEXTDESCRIPTOR PREMLOCATIONFREETEXTDESCRIPTOR,
    PMA.SECONDADDRESABLEOBJECT PREMSECONDADDRESABLEOBJECT,
    PMA.PRIMARYADDRESSABLEOBJECT PREMPRIMARYADDRESSABLEOBJECT,
    --           TRIM(PMA.ADDRESSLINE01) PREMADDRESSLINE01, -- V0.02
    PMA.ADDRESSLINE01 PREMADDRESSLINE01,
    TRIM(PMA.ADDRESSLINE02) PREMADDRESSLINE02,
    TRIM(PMA.ADDRESSLINE03) PREMADDRESSLINE03,
    TRIM(PMA.ADDRESSLINE04) PREMADDRESSLINE04,
    TRIM(PMA.ADDRESSLINE05) PREMADDRESSLINE05,
    TRIM(PMA.POSTCODE) PREMPOSTCODE,
    TRIM(PMA.PAFADDRESSKEY) PREMPAFADDRESSKEY,
    TRIM(CMA.LOCATIONFREETEXTDESCRIPTOR) CUSTLOCATIONFREETEXTDESCRIPTOR,
    TRIM(CMA.SECONDADDRESABLEOBJECT) CUSTSECONDADDRESABLEOBJECT,
    TRIM(CMA.PRIMARYADDRESSABLEOBJECT) CUSTPRIMARYADDRESSABLEOBJECT,
    --           TRIM(CMA.ADDRESSLINE01) CUSADDRESSLINE01, -- V0.02
    CMA.ADDRESSLINE01 CUSADDRESSLINE01,
    TRIM(CMA.ADDRESSLINE02) CUSADDRESSLINE02,
    TRIM(CMA.ADDRESSLINE03) CUSADDRESSLINE03,
    TRIM(CMA.ADDRESSLINE04) CUSADDRESSLINE04,
    TRIM(CMA.ADDRESSLINE05) CUSADDRESSLINE05,
    TRIM(CMA.POSTCODE) CUSTPOSTCODE,
    TRIM(CMA.COUNTRY) CUSTCOUNTRY,
    TRIM(CMA.PAFADDRESSKEY) CUSTPAFADDRESSKEY
  FROM DEL_SUPPLY_POINT DSP,
    MOUTRAN.MO_SUPPLY_POINT MSP,
    MOUTRAN.MO_ELIGIBLE_PREMISES MEP,
    MOUTRAN.MO_PROPERTY_ADDRESS MPA,
    MOUTRAN.MO_CUSTOMER MC,
    MOUTRAN.MO_CUST_ADDRESS MCA,
    MOUTRAN.MO_ADDRESS CMA, -- CUSTOMER ADDRESS
    MOUTRAN.MO_ADDRESS PMA  -- PROPERTY ADDRESS
  WHERE DSP.SPID_PK = MSP.SPID_PK
  AND MSP.STWPROPERTYNUMBER_PK = MEP.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MPA.STWPROPERTYNUMBER_PK
  AND MEP.STWPROPERTYNUMBER_PK   = MCA.STWPROPERTYNUMBER_PK
  AND MC.STWPROPERTYNUMBER_PK    = MCA.STWPROPERTYNUMBER_PK
  AND MC.CUSTOMERNUMBER_PK       = MSP.CUSTOMERNUMBER_PK
  AND MCA.CUSTOMERNUMBER_PK      = MSP.CUSTOMERNUMBER_PK
  AND MPA.ADDRESS_PK             = PMA.ADDRESS_PK
  AND MCA.ADDRESS_PK             = CMA.ADDRESS_PK
--  AND (MSP.WHOLESALERID_PK LIKE 'ANGLIAN%' OR MSP.RETAILERID_PK LIKE 'ANGLIAN%')
  AND MSP.WHOLESALERID_PK LIKE 'ANGLIAN%' --V0.05
  ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 09.DEL_SERVICE_COMPONENT_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_STW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_STW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 10.DEL_SERVICE_COMPONENT_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_THW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_THW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 11.DEL_SERVICE_COMPONENT_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_UUW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_UUW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 12.DEL_SERVICE_COMPONENT_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_YOW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_YOW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 13.DEL_SERVICE_COMPONENT_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_WEW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_WEW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 14.DEL_SERVICE_COMPONENT_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_WEL_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_WEL_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 15.DEL_SERVICE_COMPONENT_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_SSW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_SSW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 16.DEL_SERVICE_COMPONENT_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_SERVICE_COMPONENT_ANW_V ( SPID_PK, METEREDPWTARIFFCODE, MPWSPECIALAGREEMENTFLAG, MPWSPECIALAGREEMENTFACTOR, MPWSPECIALAGREEMENTREF, METEREDPWMAXDAILYDEMAND, DAILYRESERVEDCAPACITY, METEREDNPWTARIFFCODE, MNPWSPECIALAGREEMENTFLAG, MNPWSPECIALAGREEMENTFACTOR, MNPWSPECIALAGREEMENTREF, METEREDNPWMAXDAILYDEMAND, METEREDNPWDAILYRESVDCAPACITY, AWASSESSEDTARIFFCODE, AWSPECIALAGREEMENTFLAG, AWSPECIALAGREEMENTFACTOR, AWSPECIALAGREEMENTREF, AWASSESSEDCHARGEMETERSIZE, AWASSESSEDDVOLUMETRICRATE, AWASSESSEDTARIFBAND, UWUNMEASUREDTARIFFCODE, UWSPECIALAGREEMENTFLAG, UWSPECIALAGREEMENTFACTOR, UWSPECIALAGREEMENTREF, UWUNMEASUREDTYPEACOUNT, UWUNMEASUREDTYPEADESCRIPTION, UWUNMEASUREDTYPEBCOUNT, UWUNMEASUREDTYPEBDESCRIPTION, UWUNMEASUREDTYPECCOUNT, UWUNMEASUREDTYPECDESCRIPTION, UWUNMEASUREDTYPEDCOUNT, UWUNMEASUREDTYPEDDESCRIPTION, UWUNMEASUREDTYPEECOUNT, UWUNMEASUREDTYPEEDESCRIPTION, UWUNMEASUREDTYPEFCOUNT, UWUNMEASUREDTYPEFDESCRIPTION, UWUNMEASUREDTYPEGCOUNT,
  UWUNMEASUREDTYPEGDESCRIPTION, UWUNMEASUREDTYPEHCOUNT, UWUNMEASUREDTYPEHDESCRIPTION, UWPIPESIZE, WADJCHARGEADJTARIFFCODE, METEREDFSTARIFFCODE, MFSSPECIALAGREEMENTFLAG, MFSSPECIALAGREEMENTFACTOR, MFSSPECIALAGREEMENTREF, ASASSESSEDTARIFFCODE, ASSPECIALAGREEMENTFLAG, ASSPECIALAGREEMENTFACTOR, ASSPECIALAGREEMENTREF, ASASSESSEDCHARGEMETERSIZE, ASASSESSEDDVOLUMETRICRATE, ASASSESSEDTARIFBAND, USUNMEASUREDTARIFFCODE, USSPECIALAGREEMENTFLAG, USSPECIALAGREEMENTFACTOR, USSPECIALAGREEMENTREF, USUNMEASUREDTYPEACOUNT, USUNMEASUREDTYPEADESCRIPTION, USUNMEASUREDTYPEBCOUNT, USUNMEASUREDTYPEBDESCRIPTION, USUNMEASUREDTYPECCOUNT, USUNMEASUREDTYPECDESCRIPTION, USUNMEASUREDTYPEDCOUNT, USUNMEASUREDTYPEDDESCRIPTION, USUNMEASUREDTYPEECOUNT, USUNMEASUREDTYPEEDESCRIPTION, USUNMEASUREDTYPEFCOUNT, USUNMEASUREDTYPEFDESCRIPTION, USUNMEASUREDTYPEGCOUNT, USUNMEASUREDTYPEGDESCRIPTION, USUNMEASUREDTYPEHCOUNT, USUNMEASUREDTYPEHDESCRIPTION, USPIPESIZE, SADJCHARGEADJTARIFFCODE, SRFCWATERTARRIFCODE, SRFCWATERAREADRAINED,
  SRFCWATERCOMMUNITYCONFLAG, SWSPECIALAGREEMENTFLAG, SWSPECIALAGREEMENTFACTOR, SWSPECIALAGREEMENTREF, HWAYDRAINAGETARIFFCODE, HWAYSURFACEAREA, HWAYCOMMUNITYCONFLAG, HDSPECIALAGREEMENTFLAG, HDSPECIALAGREEMENTFACTOR, HDSPECIALAGREEMENTREF )
AS
  SELECT SC.SPID_PK,
    -- METERED POTABLE WATER
    SC.METEREDPWTARIFFCODE,
    SC.MPWSPECIALAGREEMENTFLAG,
    SC.MPWSPECIALAGREEMENTFACTOR,
    SC.MPWSPECIALAGREEMENTREF,
    SC.METEREDPWMAXDAILYDEMAND,
    SC.DAILYRESERVEDCAPACITY,
    -- METERED NON-POTABLE WATER
    SC.METEREDNPWTARIFFCODE,
    SC.MNPWSPECIALAGREEMENTFLAG,
    SC.MNPWSPECIALAGREEMENTFACTOR,
    SC.MNPWSPECIALAGREEMENTREF,
    SC.METEREDNPWMAXDAILYDEMAND,
    SC.METEREDNPWDAILYRESVDCAPACITY,
    -- ASSESSED WATER
    SC.AWASSESSEDTARIFFCODE,
    SC.AWSPECIALAGREEMENTFLAG,
    SC.AWSPECIALAGREEMENTFACTOR,
    SC.AWSPECIALAGREEMENTREF,
    SC.AWASSESSEDCHARGEMETERSIZE,
    SC.AWASSESSEDDVOLUMETRICRATE,
    SC.AWASSESSEDTARIFBAND,
    -- UNMEASURED WATER
    SC.UWUNMEASUREDTARIFFCODE,
    SC.UWSPECIALAGREEMENTFLAG,
    SC.UWSPECIALAGREEMENTFACTOR,
    SC.UWSPECIALAGREEMENTREF,
    SC.UWUNMEASUREDTYPEACOUNT,
    SC.UWUNMEASUREDTYPEADESCRIPTION,
    SC.UWUNMEASUREDTYPEBCOUNT,
    SC.UWUNMEASUREDTYPEBDESCRIPTION,
    SC.UWUNMEASUREDTYPECCOUNT,
    SC.UWUNMEASUREDTYPECDESCRIPTION,
    SC.UWUNMEASUREDTYPEDCOUNT,
    SC.UWUNMEASUREDTYPEDDESCRIPTION,
    SC.UWUNMEASUREDTYPEECOUNT,
    SC.UWUNMEASUREDTYPEEDESCRIPTION,
    SC.UWUNMEASUREDTYPEFCOUNT,
    SC.UWUNMEASUREDTYPEFDESCRIPTION,
    SC.UWUNMEASUREDTYPEGCOUNT,
    SC.UWUNMEASUREDTYPEGDESCRIPTION,
    SC.UWUNMEASUREDTYPEHCOUNT,
    SC.UWUNMEASUREDTYPEHDESCRIPTION,
    SC.UWPIPESIZE,
    -- WATER CHARGE ADJUSTMENT
    SC.WADJCHARGEADJTARIFFCODE,
    -- METERED FOUL SEWERAGE
    SC.METEREDFSTARIFFCODE,
    SC.MFSSPECIALAGREEMENTFLAG,
    SC.MFSSPECIALAGREEMENTFACTOR,
    SC.MFSSPECIALAGREEMENTREF,
    -- ASSESSED SEWERAGE
    SC.ASASSESSEDTARIFFCODE,
    SC.ASSPECIALAGREEMENTFLAG,
    SC.ASSPECIALAGREEMENTFACTOR,
    SC.ASSPECIALAGREEMENTREF,
    SC.ASASSESSEDCHARGEMETERSIZE,
    SC.ASASSESSEDDVOLUMETRICRATE,
    SC.ASASSESSEDTARIFBAND,
    -- UNMEASURED SEWERAGE
    SC.USUNMEASUREDTARIFFCODE,
    SC.USSPECIALAGREEMENTFLAG,
    SC.USSPECIALAGREEMENTFACTOR,
    SC.USSPECIALAGREEMENTREF,
    SC.USUNMEASUREDTYPEACOUNT,
    SC.USUNMEASUREDTYPEADESCRIPTION,
    SC.USUNMEASUREDTYPEBCOUNT,
    SC.USUNMEASUREDTYPEBDESCRIPTION,
    SC.USUNMEASUREDTYPECCOUNT,
    SC.USUNMEASUREDTYPECDESCRIPTION,
    SC.USUNMEASUREDTYPEDCOUNT,
    SC.USUNMEASUREDTYPEDDESCRIPTION,
    SC.USUNMEASUREDTYPEECOUNT,
    SC.USUNMEASUREDTYPEEDESCRIPTION,
    SC.USUNMEASUREDTYPEFCOUNT,
    SC.USUNMEASUREDTYPEFDESCRIPTION,
    SC.USUNMEASUREDTYPEGCOUNT,
    SC.USUNMEASUREDTYPEGDESCRIPTION,
    SC.USUNMEASUREDTYPEHCOUNT,
    SC.USUNMEASUREDTYPEHDESCRIPTION,
    SC.USPIPESIZE,
    -- SEWERAGE CHARGE ADJUSTMENT
    SC.SADJCHARGEADJTARIFFCODE,
    -- SURFACE WATER DRAINAGE
    SC.SRFCWATERTARRIFCODE,
    SC.SRFCWATERAREADRAINED,
    SC.SRFCWATERCOMMUNITYCONFLAG,
    SC.SWSPECIALAGREEMENTFLAG,
    SC.SWSPECIALAGREEMENTFACTOR,
    SC.SWSPECIALAGREEMENTREF,
    -- HIGHWAY DRAINAGE
    SC.HWAYDRAINAGETARIFFCODE,
    SC.HWAYSURFACEAREA,
    SC.HWAYCOMMUNITYCONFLAG,
    SC.HDSPECIALAGREEMENTFLAG,
    SC.HDSPECIALAGREEMENTFACTOR,
    SC.HDSPECIALAGREEMENTREF
  FROM DEL_SERVICE_COMPONENT SC,
       DEL_SUPPLY_POINT_ANW_V SP
  WHERE SC.SPID_PK = SP.SPID_PK
  ORDER BY SC.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 17.DEL_METER_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_STW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM
  WHERE (DM.NONMARKETMETERFLAG = 1 OR DM.SPID IN (SELECT SPID_PK FROM DEL_SUPPLY_POINT WHERE WHOLESALERID = 'SEVERN-W'))
  ORDER BY DM.MANUFACTURER_PK, DM.MANUFACTURERSERIALNUM_PK;
    
------------------------------------------------------------------------------------------------------------
-- 18.DEL_METER_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_THW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_THW_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 18.DEL_METER_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_UUW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_UUW_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 20.DEL_METER_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_YOW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_YOW_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 21.DEL_METER_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_WEW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_WEW_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 22.DEL_METER_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_WEL_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_WEL_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 23.DEL_METER_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SSW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_SSW_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 24.DEL_METER_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_ANW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, NUMBEROFDIGITS, MEASUREUNITATMETER, MEASUREUNITFREEDESCRIPTOR, PHYSICALMETERSIZE, METERREADFREQUENCY, INITIALMETERREADDATE, RETURNTOSEWER, WATERCHARGEMETERSIZE, SEWCHARGEABLEMETERSIZE, DATALOGGERWHOLESALER, DATALOGGERNONWHOLESALER, GPSX, GPSY, METERLOCFREEDESCRIPTOR, METEROUTREADERGPSX, METEROUTREADERGPSY, OUTREADERLOCFREEDES, METEROUTREADERLOCCODE, METERTREATMENT, METERLOCATIONCODE, COMBIMETERFLAG, YEARLYVOLESTIMATE, REMOTEREADFLAG, REMOTEREADTYPE, OUTREADERID, OUTREADERPROTOCOL, LOCATIONFREETEXTDESCRIPTOR, SECONDADDRESABLEOBJECT, PRIMARYADDRESSABLEOBJECT, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY)
AS
  SELECT DM.MANUFACTURERSERIALNUM_PK,
    DM.MANUFACTURER_PK,
    DM.NUMBEROFDIGITS,
    DM.MEASUREUNITATMETER,
    DM.MEASUREUNITFREEDESCRIPTOR,
    DM.PHYSICALMETERSIZE,
    DM.METERREADFREQUENCY,
    DM.INITIALMETERREADDATE,
    DM.RETURNTOSEWER,
    DM.WATERCHARGEMETERSIZE,
    DM.SEWCHARGEABLEMETERSIZE,
    DM.DATALOGGERWHOLESALER,
    DM.DATALOGGERNONWHOLESALER,
    DM.GPSX,
    DM.GPSY,
    DM.METERLOCFREEDESCRIPTOR,
    DM.METEROUTREADERGPSX,
    DM.METEROUTREADERGPSY,
    DM.OUTREADERLOCFREEDES,
    DM.METEROUTREADERLOCCODE,
    DM.METERTREATMENT,
    DM.METERLOCATIONCODE,
    DM.COMBIMETERFLAG,
    DM.YEARLYVOLESTIMATE,
    DM.REMOTEREADFLAG,
    DM.REMOTEREADTYPE,
    DM.OUTREADERID,
    DM.OUTREADERPROTOCOL,
    DM.LOCATIONFREETEXTDESCRIPTOR,
    DM.SECONDADDRESABLEOBJECT,
    DM.PRIMARYADDRESSABLEOBJECT,
    DM.ADDRESSLINE01,
    DM.ADDRESSLINE02,
    DM.ADDRESSLINE03,
    DM.ADDRESSLINE04,
    DM.ADDRESSLINE05,
    DM.POSTCODE,
    DM.PAFADDRESSKEY
  FROM DEL_METER DM,
    DEL_SUPPLY_POINT_ANW_V SP
  WHERE DM.SPID = SP.SPID_PK
  ORDER BY DM.MANUFACTURER_PK,
    DM.MANUFACTURERSERIALNUM_PK;

------------------------------------------------------------------------------------------------------------
-- 25.DEL_METER_READING_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_STW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_STW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 26.DEL_METER_READING_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_THW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_THW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 27.DEL_METER_READING_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_UUW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_UUW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 28.DEL_METER_READING_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_YOW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_YOW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 29.DEL_METER_READING_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_WEW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_WEW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 30.DEL_METER_READING_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_WEL_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_WEL_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 31.DEL_METER_READING_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_SSW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_SSW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 32.DEL_METER_READING_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_READING_ANW_V (MANUFACTURERSERIALNUM_PK, MANUFACTURER_PK, METERREAD, METERREADMETHOD, METERREADDATE, ROLLOVERINDICATOR, ESTIMATEDREADREASONCODE, ESTIMATEDREADREMEDIALWORKIND, METERREADTYPE)
AS
  SELECT MR.MANUFACTURERSERIALNUM_PK,
    MR.MANUFACTURER_PK,
    MR.METERREAD,
    MR.METERREADMETHOD,
    MR.METERREADDATE,
    MR.ROLLOVERINDICATOR,
    MR.ESTIMATEDREADREASONCODE,
    MR.ESTIMATEDREADREMEDIALWORKIND,
    MR.METERREADTYPE
  FROM DEL_METER_READING MR,
    DEL_METER_ANW_V DM
  WHERE DM.MANUFACTURER_PK        = MR.MANUFACTURER_PK
  AND DM.MANUFACTURERSERIALNUM_PK = MR.MANUFACTURERSERIALNUM_PK
  ORDER BY MR.MANUFACTURER_PK,
    MR.MANUFACTURERSERIALNUM_PK,
    MR.METERREADDATE ASC;

------------------------------------------------------------------------------------------------------------
-- 33.DEL_METER_SUPPLY_POINT_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_STW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_STW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 34.DEL_METER_SUPPLY_POINT_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_THW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_THW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 35.DEL_METER_SUPPLY_POINT_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_UUW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_UUW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 36.DEL_METER_SUPPLY_POINT_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_YOW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_YOW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 37.DEL_METER_SUPPLY_POINT_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_WEW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_WEW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 38.DEL_METER_SUPPLY_POINT_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_WEL_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_WEL_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 39.DEL_METER_SUPPLY_POINT_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_SSW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_SSW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 40.DEL_METER_SUPPLY_POINT_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_SUPPLY_POINT_ANW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,SPID_PK) AS
    SELECT MSP.MANUFACTURERSERIALNUM_PK,
           MSP.MANUFACTURER_PK,
           MSP.SPID_PK
    FROM DEL_METER_SUPPLY_POINT MSP,
         DEL_SUPPLY_POINT_ANW_V SP
    WHERE MSP.SPID_PK = SP.SPID_PK
    ORDER BY MSP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 41.DEL_METER_NETWORK_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE FORCE VIEW DEL_METER_NETWORK_STW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER)
AS
  SELECT
    DMN.SPID_PK,
    DMN.MAINMANUFACTURERSERIALNUM,
    DMN.MAINMANUFACTURER,
    DMN.SUBMANUFACTURERSERIALNUM,
    DMN.SUBMANUFACTURER
  FROM DEL_METER_NETWORK DMN
--v0.07    
--         ,DEL_SUPPLY_POINT_STW_V SP
--  WHERE DMN.SPID_PK = SP.SPID_PK
WHERE ((DMN.MAINNONMARKETFLAG = 1)
        OR DMN.SPID_PK IN
            (SELECT SPID_PK FROM DEL_SUPPLY_POINT WHERE WHOLESALERID = 'SEVERN-W')
        )
  ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 42.DEL_METER_NETWORK_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_THW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_THW_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 43.DEL_METER_NETWORK_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_UUW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_UUW_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 44.DEL_METER_NETWORK_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_YOW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_YOW_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 45.DEL_METER_NETWORK_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_WEW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_WEW_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 46.DEL_METER_NETWORK_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_WEL_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_WEL_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 47.DEL_METER_NETWORK_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_SSW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_SSW_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 48.DEL_METER_NETWORK_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_NETWORK_ANW_V (SPID_PK, MAINMANUFACTURERSERIALNUM, MAINMANUFACTURER, SUBMANUFACTURERSERIALNUM, SUBMANUFACTURER) AS
    SELECT DMN.SPID_PK,
        DMN.MAINMANUFACTURERSERIALNUM,
        DMN.MAINMANUFACTURER,
        DMN.SUBMANUFACTURERSERIALNUM,
        DMN.SUBMANUFACTURER
    FROM DEL_METER_NETWORK DMN,
         DEL_SUPPLY_POINT_ANW_V SP
    WHERE DMN.SPID_PK = SP.SPID_PK
    ORDER BY DMN.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 49.DEL_DISCHARGE_POINT_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_STW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
  ) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04    
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_STW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 50.DEL_DISCHARGE_POINT_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_THW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04    
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_THW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 51.DEL_DISCHARGE_POINT_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_UUW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04    
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04    
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_UUW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 52.DEL_DISCHARGE_POINT_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_YOW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04    
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04    
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_YOW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 53.DEL_DISCHARGE_POINT_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_WEW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04    
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_WEW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 54.DEL_DISCHARGE_POINT_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_WEL_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04    
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_WEL_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 55.DEL_DISCHARGE_POINT_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_SSW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP  --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04    
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_SSW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 56.DEL_DISCHARGE_POINT_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_DISCHARGE_POINT_ANW_V (SPID_PK, DPID_PK, TARRIFCODE, TARRIFBAND, TREFODCHEMOXYGENDEMAND, TREFODCHEMSUSPSOLDEMAND, TREFODCHEMAMONIANITROGENDEMAND, TREFODCHEMCOMPXDEMAND, TREFODCHEMCOMPYDEMAND, TREFODCHEMCOMPZDEMAND, SEWERAGEVOLUMEADJMENTHOD, RECEPTIONTREATMENTINDICATOR, PRIMARYTREATMENTINDICATOR, MARINETREATMENTINDICATOR, BIOLOGICALTREATMENTINDICATOR, SLUDGETREATMENTINDICATOR, AMMONIATREATMENTINDICATOR, TEFXTREATMENTINDICATOR, TEFYTREATMENTINDICATOR, TEFZTREATMENTINDICATOR, TEFAVAILABILITYDATAX, TEFAVAILABILITYDATAY, TEFAVAILABILITYDATAZ, CHARGEABLEDAILYVOL, CHEMICALOXYGENDEMAND, SUSPENDEDSOLIDSLOAD, AMMONIANITROCAL, FIXEDALLOWANCE, PERCENTAGEALLOWANCE, DOMMESTICALLOWANCE, SEASONALFACTOR, DPIDSPECIALAGREEMENTINPLACE, DPIDSPECIALAGREEMENTFACTOR, DPIDSPECIALAGREEMENTREFERENCE, FREETEXTDESCRIPTOR, SECONDADDRESSABLEOBJ, PRIMARYADDRESSABLEOBJ, ADDRESSLINE01, ADDRESSLINE02, ADDRESSLINE03, ADDRESSLINE04, ADDRESSLINE05, POSTCODE, PAFADDRESSKEY
--, VALIDTETARIFFCODE, TARIFFBANDCOUNT, AMMONIACALNITROGEN, XCOMP, YCOMP, ZCOMP --v0.04
) AS
  SELECT DP.SPID_PK,
    DP.DPID_PK,
    DP.TARRIFCODE,
    DP.TARRIFBAND,
    DP.TREFODCHEMOXYGENDEMAND,
    DP.TREFODCHEMSUSPSOLDEMAND,
    DP.TREFODCHEMAMONIANITROGENDEMAND,
    DP.TREFODCHEMCOMPXDEMAND,
    DP.TREFODCHEMCOMPYDEMAND,
    DP.TREFODCHEMCOMPZDEMAND,
    DP.SEWERAGEVOLUMEADJMENTHOD,
    DP.RECEPTIONTREATMENTINDICATOR,
    DP.PRIMARYTREATMENTINDICATOR,
    DP.MARINETREATMENTINDICATOR,
    DP.BIOLOGICALTREATMENTINDICATOR,
    DP.SLUDGETREATMENTINDICATOR,
    DP.AMMONIATREATMENTINDICATOR,
    DP.TEFXTREATMENTINDICATOR,
    DP.TEFYTREATMENTINDICATOR,
    DP.TEFZTREATMENTINDICATOR,
    DP.TEFAVAILABILITYDATAX,
    DP.TEFAVAILABILITYDATAY,
    DP.TEFAVAILABILITYDATAZ,
    DP.CHARGEABLEDAILYVOL,
    DP.CHEMICALOXYGENDEMAND,
    DP.SUSPENDEDSOLIDSLOAD,
    DP.AMMONIANITROCAL,
    DP.FIXEDALLOWANCE,
    DP.PERCENTAGEALLOWANCE,
    DP.DOMMESTICALLOWANCE,
    DP.SEASONALFACTOR,
    DP.DPIDSPECIALAGREEMENTINPLACE,
    DP.DPIDSPECIALAGREEMENTFACTOR,
    DP.DPIDSPECIALAGREEMENTREFERENCE,
    DP.FREETEXTDESCRIPTOR,
    DP.SECONDADDRESSABLEOBJ,
    DP.PRIMARYADDRESSABLEOBJ,
    DP.ADDRESSLINE01,
    DP.ADDRESSLINE02,
    DP.ADDRESSLINE03,
    DP.ADDRESSLINE04,
    DP.ADDRESSLINE05,
    DP.POSTCODE,
    DP.PAFADDRESSKEY
--*** v0.04    
    --,
    --DP.VALIDTETARIFFCODE,
    --DP.TARIFFBANDCOUNT,
    --DP.AMMONIACALNITROGEN,
    --DP.XCOMP,
    --DP.YCOMP,
    --DP.ZCOMP
--*** v0.04
  FROM DEL_DISCHARGE_POINT DP,
    DEL_SUPPLY_POINT_ANW_V SP
  WHERE DP.SPID_PK = SP.SPID_PK;

------------------------------------------------------------------------------------------------------------
-- 57.DEL_METER_DISCHARGE_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_STW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_STW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 58.DEL_METER_DISCHARGE_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_THW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_THW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 59.DEL_METER_DISCHARGE_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_UUW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_UUW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 60.DEL_METER_DISCHARGE_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_YOW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_YOW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 61.DEL_METER_DISCHARGE_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_WEW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_WEW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 62.DEL_METER_DISCHARGE_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_WEL_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_WEL_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 63.DEL_METER_DISCHARGE_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_SSW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_SSW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 64.DEL_METER_DISCHARGE_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_METER_DISCHARGE_ANW_V (MANUFACTURERSERIALNUM_PK,MANUFACTURER_PK,DPID_PK,PERCENTAGEDISCHARGE) AS
    SELECT MD.MANUFACTURERSERIALNUM_PK,
           MD.MANUFACTURER_PK,
           MD.DPID_PK,
           MD.PERCENTAGEDISCHARGE
    FROM DEL_METER_DISCHARGE_POINT MD,
         DEL_DISCHARGE_POINT_ANW_V DP
    WHERE MD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 65.DEL_CALC_DISCHARGE_STW_V (Severn Trent Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_STW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_STW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 66.DEL_CALC_DISCHARGE_THW_V (Thames Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_THW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_THW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 67.DEL_CALC_DISCHARGE_UUW_V (United Utilities)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_UUW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_UUW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 68.DEL_CALC_DISCHARGE_YOW_V (Yorkshire Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_YOW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_YOW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 69.DEL_CALC_DISCHARGE_WEW_V (Wessex Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_WEW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_WEW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 70.DEL_CALC_DISCHARGE_WEL_V (Dwr Cymru)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_WEL_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_WEL_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 71.DEL_CALC_DISCHARGE_SSW_V (South Staffs Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_SSW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_SSW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- 72.DEL_CALC_DISCHARGE_ANW_V (Anglian Water)
------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE VIEW DEL_CALC_DISCHARGE_ANW_V (DPID_PK,CALCDISCHARGEID_PK,DISCHARGETYPE,SUBMISSIONFREQ,TEYEARLYVOLESTIMATE) AS
    SELECT CD.DPID_PK,
           CD.CALCDISCHARGEID_PK,
           CD.DISCHARGETYPE,
           CD.SUBMISSIONFREQ,
           CD.TEYEARLYVOLESTIMATE
    FROM DEL_CALCULATED_DISCHARGE CD,
         DEL_DISCHARGE_POINT_ANW_V DP
    WHERE CD.DPID_PK = DP.DPID_PK;

------------------------------------------------------------------------------------------------------------
-- POPULATE BT_CROSSBORDER_CTRL table - only turn on STW initially
------------------------------------------------------------------------------------------------------------
TRUNCATE TABLE BT_CROSSBORDER_CTRL;
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('ANGLIAN-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('DWRCYMRU-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('SEVERN-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('SEVERN-A',0);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('SEVERN-B',0);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('THAMES-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('WESSEX-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('YORKSHIRE-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('UNITED-W',1);
INSERT INTO BT_CROSSBORDER_CTRL (WHOLESALER_ID,RUN_FLAG) VALUES ('SOUTHSTAFF-W',1);
COMMIT;

exit;